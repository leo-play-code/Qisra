{% load static %}
{% load i18n %}




<link rel="stylesheet" type="text/css" href="{% static 'colresizable/samples/colResizable/css/main.css' %}" />  
<link rel="stylesheet" type="text/css" href="{% static 'css/resize_table.css' %}" />  

<script src="{% static 'colresizable/colResizable-1.6.js' %}"></script>
<!-- <script type="text/javascript">
    $(function(){	
        $("#teststepview_table").colResizable({
            liveDrag:true, 
            gripInnerHtml:"<div class='grip'></div>", 
            draggingClass:"dragging", 
            resizeMode:'overflow'
        }); 
    });	
</script> -->
<div>
    <div id="edit_testrun_table" style="float: left;">
        <p style="color:green ;">添加 Testcase:
            <select class="selectpicker" multiple data-live-search="true" id="select_testcase">   
                {% for testcase in testcase_object %}
                    {% if testcase not in testcase_list %}
                        <option value="{{testcase.id}}">{{testcase.name}}</option>
                    {% endif %}
                {% endfor %}
            </select>
        </p>
    </div>
    <button style="float:left" type="submit" class="btn btn-md cleared" onclick="return _Add_testcase(this)" id="Edit_teststep_btn"><i class="fa-solid fa-plus"></i></button>
</div>
<div class="scroll_all" id="resize_scroll_teststep_table" >
    <table id="teststepview_table"  border="0" cellpadding="0" cellspacing="0">
        <thead>
            <tr class="header">
                <th style="width: 100px;">TC.ID</th>
                <th>TC.Name</th>    
                {% for testplan in testplan_list %}
                    <th class="status_show_position">
                        {{testplan.name}}
                        <input type="hidden" value="{{testplan.id}}" id="checkbox_id">
                        <input type="checkbox" class="hidden testplan_check_all" onclick="_check_all(this)">
                    </th>
                {% endfor %}
                <th> 
                    <button type="submit" class="btn btn-md cleared" onclick="return _Show_testplan_input(this)" id="show_testplan_input_btn"><i class="fa-solid fa-plus"></i></button>
                    <div>
                        <div style="float: left;">
                            <input style="width:300px ;" type="text" id="new_testplan_name" name="new_testplan_name" class="form-control hidden" placeholder="New Testplan Name" >
                        </div>
                        <div style="float: right;" class="status_show_position">
                            <button type="submit" class="btn btn-md cleared hidden" onclick="return _Add_testplan(this)" id="add_testplan_btn" style="color: green;"><i class="fa-solid fa-check"></i></button>
                            <button type="submit" class="btn btn-md cleared hidden" onclick="return _Cancel_Add_testplan(this)" id="cancel_testplan_btn" style="color: red;"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                    </div>
                </th>
            </tr>
        </thead>


        <tbody id="teststep_tr_list_savemode">
            {% for testcase,testrun_list in testcase_dict.items %}
                <tr>
                    <td><a href="{% url 'teststep' testcase.id %}">TEM-{{testcase.id}}</a></td>
                    <td>
                        {{testcase.name}}
                        <input type="hidden" value="{{testcase.id}}" id="checkbox_id">
                        <input type="checkbox" class="hidden testcase_check_all" onclick="_check_all(this)">
                    </td>
                    {% for data in testrun_list %}
                        {% if data.1 != 'None' %}
                        <td tyle="float: left;">
                            <div><input type="checkbox" class="testplan_testcase_checkbox_checked"  checked disabled></div>
                        </td>
                        {% else %}
                        <td tyle="float: left;"><input type="checkbox" class="testplan_testcase_checkbox testplan_checkbox_{{data.0.id}} testcase_checkbox_{{testcase.id}}" id="TestplanID-{{data.0.id}}-TestcaseID-{{testcase.id}}"  disabled></td>
                        {% endif %}
                    {% endfor %}
                  
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    {% for data in testrun_list %}
                        {% if data.1 != 'None' %}
                        <td >
                            <div>
                                {% if data.1.status == 'Incomplete' %}
                                    <a href="{% url 'testrun' data.1.id %}" style="color:#B7950B">{{data.1.status}}</a>
                                {% elif data.1.status == 'Passed' %}
                                    <a href="{% url 'testrun' data.1.id %}" style="color:#229954">{{data.1.status}}</a>
                                {% elif data.1.status == 'Failed' %}
                                    <a href="{% url 'testrun' data.1.id %}" style="color:#CB4335">{{data.1.status}}</a>
                                {% elif data.1.status == 'Ongoing' %}
                                    <a href="{% url 'testrun' data.1.id %}" style="color:#2471A3">In Progress</a>
                                {% endif %}
                            </div>
                            <div>
                                {% for assign_item in data.1.assign.all%}
                                    {{assign_item}}
                                {% endfor %}
                            </div>
                        </td>
                        {% else %}
                        <td>
                            <div></div>
                            <div></div>
                        </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>